<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mobile Royale</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
body { margin:0; overflow:hidden; background:black; font-family:Arial; }

#menu{
 position:fixed; inset:0;
 background:linear-gradient(#111,#000);
 display:flex; flex-direction:column;
 justify-content:center; align-items:center;
 color:white; z-index:20;
}
#menu button{
 padding:15px 30px; font-size:20px;
 border:none; border-radius:10px;
}

#hud{
 position:fixed; top:10px; left:10px;
 color:white; z-index:10;
}

#crosshair{
 position:fixed; top:50%; left:50%;
 width:20px; height:20px;
 margin-left:-10px; margin-top:-10px;
 border:2px solid white; border-radius:50%;
 z-index:10;
}

#shootBtn{
 position:fixed; bottom:60px; right:40px;
 width:80px; height:80px;
 border-radius:50%; background:red;
 opacity:0.6;
}

#runBtn{
 position:fixed; bottom:160px; right:50px;
 width:60px; height:60px;
 border-radius:50%; background:yellow;
 opacity:0.6;
}

#moveArea{
 position:fixed; bottom:0; left:0;
 width:50%; height:60%;
}

#lookArea{
 position:fixed; top:0; right:0;
 width:50%; height:100%;
}
</style>
</head>
<body>

<div id="menu">
<h1>ðŸ”¥ Mobile Royale ðŸ”¥</h1>
<button onclick="startGame()">JOGAR</button>
</div>

<div id="hud">
Vida: <span id="health">100</span><br>
Kills: <span id="kills">0</span>
</div>

<div id="crosshair"></div>
<div id="shootBtn"></div>
<div id="runBtn"></div>
<div id="moveArea"></div>
<div id="lookArea"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script>

let scene, camera, renderer;
let enemies=[];
let health=100;
let kills=0;
let running=false;
let moveF=0, lookX=0, lookY=0;

function startGame(){
 document.getElementById("menu").style.display="none";
 init();
 animate();
}

function init(){

 scene=new THREE.Scene();
 scene.background=new THREE.Color(0x87ceeb);

 camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
 camera.position.y=1.6;

 renderer=new THREE.WebGLRenderer({antialias:true});
 renderer.setSize(innerWidth,innerHeight);
 document.body.appendChild(renderer.domElement);

 let light=new THREE.DirectionalLight(0xffffff,1);
 light.position.set(10,20,10);
 scene.add(light);
 scene.add(new THREE.AmbientLight(0xffffff,0.4));

 let ground=new THREE.Mesh(
  new THREE.PlaneGeometry(300,300),
  new THREE.MeshStandardMaterial({color:0x228B22})
 );
 ground.rotation.x=-Math.PI/2;
 scene.add(ground);

 // arma simples
 let gun=new THREE.Mesh(
  new THREE.BoxGeometry(0.3,0.3,1),
  new THREE.MeshStandardMaterial({color:0x222222})
 );
 gun.position.set(0.4,-0.4,-1);
 camera.add(gun);
 scene.add(camera);

 // inimigos com cabeÃ§a
 for(let i=0;i<6;i++){
  let body=new THREE.Mesh(
   new THREE.BoxGeometry(1,1.5,1),
   new THREE.MeshStandardMaterial({color:0xff0000})
  );
  body.position.set(Math.random()*100-50,0.75,Math.random()*100-50);

  let head=new THREE.Mesh(
   new THREE.BoxGeometry(0.7,0.7,0.7),
   new THREE.MeshStandardMaterial({color:0xaa0000})
  );
  head.position.y=1.3;
  body.add(head);

  body.health=100;
  body.head=head;

  scene.add(body);
  enemies.push(body);
 }

 setupControls();
}

function setupControls(){

 document.getElementById("runBtn").ontouchstart=()=>running=true;
 document.getElementById("runBtn").ontouchend=()=>running=false;

 document.getElementById("moveArea").ontouchmove=e=>{
  moveF=(innerHeight-e.touches[0].clientY)/innerHeight;
 };
 document.getElementById("moveArea").ontouchend=()=>moveF=0;

 document.getElementById("lookArea").ontouchmove=e=>{
  lookX=e.touches[0].movementX||0;
  lookY=e.touches[0].movementY||0;
 };

 document.getElementById("shootBtn").ontouchstart=shoot;
}

function shoot(){

 let audio=new Audio("https://actions.google.com/sounds/v1/impacts/wood_plank_flicks.ogg");
 audio.play();

 let ray=new THREE.Raycaster();
 ray.setFromCamera(new THREE.Vector2(0,0),camera);
 let hits=ray.intersectObjects(enemies,true);

 if(hits.length>0){
  let obj=hits[0].object;

  let parent=obj.parent.type==="Scene"?obj:obj.parent;

  if(obj===parent.head){
   parent.health-=100; // headshot
  }else{
   parent.health-=40;
  }

  if(parent.health<=0){
   scene.remove(parent);
   enemies.splice(enemies.indexOf(parent),1);
   kills++;
  }
 }
}

function animate(){
 requestAnimationFrame(animate);

 camera.rotation.y-=lookX*0.002;
 camera.rotation.x-=lookY*0.002;
 camera.rotation.x=Math.max(-1.4,Math.min(1.4,camera.rotation.x));

 let speed=running?0.3:0.15;
 camera.position.x+=Math.sin(camera.rotation.y)*moveF*speed;
 camera.position.z+=Math.cos(camera.rotation.y)*moveF*speed;

 enemies.forEach(e=>{
  let dir=camera.position.clone().sub(e.position).normalize();
  e.position.add(dir.multiplyScalar(0.03));
  if(e.position.distanceTo(camera.position)<1.5){
   health-=0.3;
   if(health<=0){
    alert("DERROTA");
    location.reload();
   }
  }
 });

 if(kills>=10){
  alert("VITÃ“RIA!");
  location.reload();
 }

 document.getElementById("health").innerText=Math.floor(health);
 document.getElementById("kills").innerText=kills;

 renderer.render(scene,camera);
}

</script>
</body>
</html>
